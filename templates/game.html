<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="/static/styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Ensure responsiveness on mobile devices -->
    <title>Card Game</title>
</head>
<body>
    <div class="content">
        <h1>Welcome, {{ session['name'] }}</h1>
        <button onclick="drawCard()">Draw Card</button>
        <button onclick="shuffleDeck()">Reshuffle</button>
        <div id="output"></div>
        <h3>My Cards:</h3>
        <div id="cardList"></div>
        <!-- Image container for the drawn card -->
        <div id="cardImageContainer">
            <img id="cardImage" src="" alt="Drawn card will appear here" style="max-width:100%; height:auto;">
        </div>
    </div>

    <script>
        async function fetchAPI(url) {
            const response = await fetch(url);
            const data = await response.json();
            if (!response.ok) {
                return alert(data.error);
            }
            return data;
        }

        function drawCard() {
            fetchAPI('/draw').then(data => {
                document.getElementById('output').textContent = `Drawn Card: ${data.card}, Remaining: ${data.remaining}`;
                // Update the image source with the URL provided by the server
                document.getElementById('cardImage').src = data.card_img_url || '';
                updateCardList();
            });
        }

        function shuffleDeck() {
            fetchAPI('/shuffle').then(data => {
                alert(data.message);
                updateCardList(); // Update card list after reshuffling
            });
        }

        function updateCardList() {
            fetch('/show').then(response => response.json())
                .then(data => {
                    let cardListHTML = '';
                    data.cards.forEach(card => {
                        cardListHTML += `<img src="/static/AllCardImages/${card}.png" alt="Card Image" class="card-image">`; // Update to match your file naming if needed
                    });
                    document.getElementById('cardList').innerHTML = cardListHTML;
                });
        }

        // Initial call to update card list on page load
        updateCardList();
    </script>
</body>
</html>
